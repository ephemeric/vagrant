# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
    config.vm.define "test" do |d|
        #d.vm.box = BOX
        #d.vm.box_version = VERSION
        d.vm.hostname = "test" + DOMAIN
        d.vm.network :private_network, \
        :ip => "192.168.235.22", \
        :libvirt__network_name => "hotrod", \
        :libvirt__dhcp_enabled => false, \
        :libvirt__always_destroy => true, \
        :libvirt__guest_ipv6 => false, \
        :libvirt__forward_mode => "veryisolated", \
        :libvirt__host_ip => "192.168.235.1"
        #d.vm.synced_folder "upload", "/upload", owner: "root", group: "root"
        d.vm.provider "libvirt" do |l|
            l.memory = 2048
            l.cpus = 4
        end
        d.vm.provision :shell, inline: <<-SHELL
            if [[ '#{ENV['PROXY']}' == "true" ]]; then
                /tmp/scripts/proxy.sh
            fi
            export DEBIAN_FRONTEND=noninteractive
            apt-get update
            apt-get -y install docker.io
            docker pull nginx
        SHELL
    end
end
